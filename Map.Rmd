```{r}
library(tidyverse)
library(viridis)
library(ggplot2)
library(sf)

total_for_models <- read.csv("Data_files/total_for_models.csv")
map <- st_read("Pipposhape/pippo shape/cap_NO.shp")
```
```{r}
total_for_models$cap <- as.factor(total_for_models$cap)

population <- total_for_models %>%
  group_by(cap) %>%
  summarize(customers = n())

colnames(population)[colnames(population) == "cap"] <- "IT_CAP"

n_customers <- merge(map, population, by="IT_CAP", all.x = TRUE)
```

```{r}
n_customers %>% 
  ggplot() +
  geom_sf(aes(fill=customers)) +
  scale_fill_viridis(option="turbo", na.value = "lightgrey") +
  theme_void()
```

```{r}
n_customers %>%
  filter(IT_CAP < 11000) %>%
  ggplot() +
  geom_sf(aes(fill=customers)) +
  scale_fill_viridis(option="turbo", na.value = "lightgrey") +
  theme_void()
```
